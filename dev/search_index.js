var documenterSearchIndex = {"docs":
[{"location":"#EvolutionModels","page":"Home","title":"EvolutionModels","text":"Documentation for EvolutionModels.\n\nüöß Work in Progress: This package is under active development.","category":"section"},{"location":"#Introduction-to-DNA-Substitution-Models","page":"Home","title":"Introduction to DNA Substitution Models","text":"","category":"section"},{"location":"#Jukes-Cantor-(JC69)","page":"Home","title":"Jukes-Cantor (JC69)","text":"The simplest model of DNA evolution, assuming:\n\nEqual base frequencies (œÄA = œÄC = œÄG = œÄT = 1/4)\nEqual substitution rates between all nucleotides\nSingle parameter Œº controlling overall mutation rate\n\nRate matrix Q has form:\n\nQ = beginpmatrix\n-3alpha  alpha  alpha  alpha \nalpha  -3alpha  alpha  alpha \nalpha  alpha  -3alpha  alpha \nalpha  alpha  alpha  -3alpha\nendpmatrix\n\nwhere Œ± = Œº/4","category":"section"},{"location":"#HKY85-Model","page":"Home","title":"HKY85 Model","text":"Extends JC69 by introducing:\n\nArbitrary base frequencies (œÄA, œÄC, œÄG, œÄT)\nDifferent rates for transitions (A‚ÜîG, C‚ÜîT) vs transversions\nRate ratio Œ∫ between transitions and transversions\n\nRate matrix elements:\n\nq_ij = begincases\nmukappapi_j  textfor transitions \nmupi_j  textfor transversions \n-sum_kneq i q_ik  textfor  i = j\nendcases","category":"section"},{"location":"#General-Time-Reversible-(GTR)","page":"Home","title":"General Time-Reversible (GTR)","text":"Most general neutral model with properties:\n\nArbitrary base frequencies œÄ\nSix substitution rate parameters (rAC, rAG, rAT, rCG, rCT, rGT)\nSatisfies detailed balance: œÄ·µ¢q·µ¢‚±º = œÄ‚±ºq‚±º·µ¢\n\nRate matrix Q = {q·µ¢‚±º} where:\n\nq_ij = begincases\nmu r_ijpi_j  textfor  i neq j \n-sum_kneq i q_ik  textfor  i = j\nendcases\n\nNote: Both JC69 and HKY85 are special cases of GTR with appropriate constraints on rates and frequencies.","category":"section"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"#Basic-Example","page":"Home","title":"Basic Example","text":"using EvolutionModels\nusing BioSequences\n\n# Create JC69 model\nmodel = create_model(JC69Model, 0.1)\n\n# Simulate evolution\nseq = dna\"ATCG\"\nevolved = evolve_sequence(model, seq, 1.0)\n\n# Compute likelihood\nlogL = sequence_likelihood(model, seq, evolved, 1.0)","category":"section"},{"location":"#Distance-Computation","page":"Home","title":"Distance Computation","text":"using EvolutionModels\nusing FASTX\nusing Optim\n\n# Read alignment\nseqs = read_alignment(\"alignment.fasta\")\n\n# Create model and compute distances\nmodel = create_model(JC69Model, 0.1)\nresult = compute_distances(model, seqs)\n\n# Print distance matrix\nprint_distance_matrix(result)","category":"section"},{"location":"#Using-GTR-Model","page":"Home","title":"Using GTR Model","text":"# Define base frequencies\nœÄ = [0.3, 0.2, 0.2, 0.3]  # A,C,G,T\n\n# Define GTR rates\nrates = GTRRates(\n    1.0,  # A‚ÜîC\n    2.0,  # A‚ÜîG\n    1.0,  # A‚ÜîT\n    1.0,  # C‚ÜîG\n    2.0,  # C‚ÜîT\n    1.0   # G‚ÜîT\n)\n\n# Create model\nmodel = create_model(GTRModel, 0.1, œÄ, rates)","category":"section"},{"location":"#API-Reference","page":"Home","title":"API Reference","text":"","category":"section"},{"location":"#EvolutionModels.DNAModel","page":"Home","title":"EvolutionModels.DNAModel","text":"DNAModel <: EvolutionModel\n\nAbstract type for DNA evolution models.\n\n\n\n\n\n","category":"type"},{"location":"#EvolutionModels.EvolutionModel","page":"Home","title":"EvolutionModels.EvolutionModel","text":"EvolutionModel\n\nAbstract type for all molecular evolution models.\n\n\n\n\n\n","category":"type"},{"location":"#EvolutionModels.Model","page":"Home","title":"EvolutionModels.Model","text":"Model{S<:SequenceType}\n\nConcrete implementation of an evolution model.\n\n\n\n\n\n","category":"type"},{"location":"#EvolutionModels.ProteinModel","page":"Home","title":"EvolutionModels.ProteinModel","text":"ProteinModel <: EvolutionModel\n\nAbstract type for protein evolution models.\n\n\n\n\n\n","category":"type"},{"location":"#EvolutionModels.SequenceType","page":"Home","title":"EvolutionModels.SequenceType","text":"SequenceType\n\nAbstract type for sequence alphabets (DNA or Protein).\n\n\n\n\n\n","category":"type"},{"location":"#EvolutionModels.compute_q_matrix-Tuple{Matrix{Float64}, LinearAlgebra.Diagonal{Float64, V} where V<:AbstractVector{Float64}}","page":"Home","title":"EvolutionModels.compute_q_matrix","text":"Compute Q matrix (generator matrix) from R and P.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.create_model-Tuple{Type{GTRModel}, Float64, Vector{Float64}, Matrix{Float64}}","page":"Home","title":"EvolutionModels.create_model","text":"create_model(::Type{GTRModel}, Œº::Float64, œÄ::Vector{Float64}, rates::Matrix{Float64}) -> Model{DNAType}\n\nCreate a General Time-Reversible (GTR) model of DNA evolution.\n\nThe GTR model is the most general neutral, independent sites, reversible model:\n\nArbitrary base frequencies œÄ\nArbitrary symmetric rate matrix\nSatisfies detailed balance: œÄ·µ¢q·µ¢‚±º = œÄ‚±ºq‚±º·µ¢\n\nArguments\n\nŒº::Float64: Overall mutation rate scaling factor (must be positive)\nœÄ::Vector{Float64}: Vector of base frequencies [œÄA, œÄC, œÄG, œÄT], must sum to 1\nrates::Matrix{Float64}: 4√ó4 symmetric matrix of relative substitution rates\n\nReturns\n\nModel{DNAType}: A GTR model with rate matrix Q = ŒºR‚ãÖdiag(œÄ) where:\nR is the symmetric rate matrix\nq·µ¢‚±º = Œºr·µ¢‚±ºœÄ‚±º for i ‚â† j\nq·µ¢·µ¢ = -‚àë‚±º‚â†·µ¢ q·µ¢‚±º\n\nExample\n\n# Create GTR model with custom rates\nœÄ = [0.3, 0.2, 0.2, 0.3]  # Base frequencies\nrates = [0.0 1.0 2.0 1.0;  # Symmetric rate matrix\n         1.0 0.0 1.0 2.0;\n         2.0 1.0 0.0 1.0;\n         1.0 2.0 1.0 0.0]\nmodel = create_model(GTRModel, 0.1, œÄ, rates)\n\nReferences\n\nTavar√©, S. (1986). Some probabilistic and statistical problems in the analysis of DNA sequences. Lectures on Mathematics in the Life Sciences, 17:57-86.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.create_model-Tuple{Type{HKY85Model}, Float64, Vector{Float64}, Float64}","page":"Home","title":"EvolutionModels.create_model","text":"create_model(::Type{HKY85Model}, Œº::Float64, œÄ::Vector{Float64}, Œ∫::Float64) -> Model{DNAType}\n\nCreate a Hasegawa-Kishino-Yano (1985) model of DNA evolution.\n\nThe HKY85 model features:\n\nArbitrary base frequencies œÄ\nDifferent rates for transitions (A‚ÜîG, C‚ÜîT) vs transversions\nRate ratio Œ∫ between transitions and transversions\n\nArguments\n\nŒº::Float64: Overall mutation rate scaling factor (must be positive)\nœÄ::Vector{Float64}: Vector of base frequencies [œÄA, œÄC, œÄG, œÄT], must sum to 1\nŒ∫::Float64: Transition/transversion rate ratio (must be positive)\n\nReturns\n\nModel{DNAType}: An HKY85 model with rate matrix Q where:\nq·µ¢‚±º = ŒºŒ∫œÄ‚±º for transitions\nq·µ¢‚±º = ŒºœÄ‚±º for transversions\nq·µ¢·µ¢ = -‚àë‚±º‚â†·µ¢ q·µ¢‚±º\n\nExample\n\n# Create HKY85 model with unequal base frequencies\nœÄ = [0.3, 0.2, 0.2, 0.3]  # A,C,G,T frequencies\nmodel = create_model(HKY85Model, 0.1, œÄ, 2.0)  # Œ∫=2 means transitions occur 2√ó faster\n\nReferences\n\nHasegawa, M., Kishino, H., and Yano, T. (1985). Dating of the human-ape splitting by a molecular clock of mitochondrial DNA. J. Mol. Evol., 22(2):160-174.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.create_model-Tuple{Type{JC69Model}, Float64}","page":"Home","title":"EvolutionModels.create_model","text":"create_model(::Type{JC69Model}, Œº::Float64) -> Model{DNAType}\n\nCreate a Jukes-Cantor (1969) model of DNA evolution.\n\nThe JC69 model assumes:\n\nEqual base frequencies (œÄ = 0.25 for all bases)\nEqual substitution rates between all nucleotides\nSingle parameter Œº controlling overall mutation rate\n\nArguments\n\nŒº::Float64: Overall mutation rate scaling factor (must be positive)\n\nReturns\n\nModel{DNAType}: A JC69 model with rate matrix Q where:\nq·µ¢‚±º = Œº/4 for i ‚â† j (off-diagonal elements)\nq·µ¢·µ¢ = -3Œº/4 (diagonal elements)\n\nExample\n\n# Create JC69 model with rate 0.1\nmodel = create_model(JC69Model, 0.1)\n\n# Access model properties\nœÄ = stationary_frequencies(model)  # All 0.25\nR = rate_matrix(model)  # Symmetric rate matrix\n\nReferences\n\nJukes, T.H. and Cantor, C.R. (1969). Evolution of Protein Molecules.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.create_model-Tuple{Type{LGModel}, Float64}","page":"Home","title":"EvolutionModels.create_model","text":"create_model(::Type{LGModel}, Œº::Float64)\n\nCreate an LG (Le-Gascuel) protein evolution model with specified rate scaling factor Œº. Returns a Model{ProteinType} with empirical substitution rates and frequencies.\n\nThe LG model is derived from 3,912 protein families using maximum likelihood methods, improving upon previous models by incorporating rate variation across sites. The amino acid order follows STANDARD_AA: A R N D C Q E G H I L K M F P S T W Y V\n\nCitation\n\nLe, S. Q., & Gascuel, O. (2008). An improved general amino acid replacement matrix. Molecular Biology and Evolution, 25(7), 1307-1320. DOI: 10.1093/molbev/msn067\n\nArguments\n\nŒº::Float64: Rate scaling factor (must be positive)\n\nReturns\n\nModel{ProteinType}: Configured LG model\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.create_model-Tuple{Type{WAGModel}, Float64}","page":"Home","title":"EvolutionModels.create_model","text":"create_model(::Type{WAGModel}, Œº::Float64)\n\nCreate a WAG (Whelan And Goldman) protein evolution model with specified rate scaling factor Œº. Returns a Model{ProteinType} with empirical substitution rates and frequencies.\n\nThe WAG model is derived from 182 protein families using maximum likelihood methods, providing both substitution rates and equilibrium frequencies estimated from the data. The amino acid order follows STANDARD_AA: A R N D C Q E G H I L K M F P S T W Y V\n\nCitation\n\nWhelan, S., & Goldman, N. (2001). A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach. Molecular Biology and Evolution, 18(5), 691-699. DOI: 10.1093/oxfordjournals.molbev.a003851\n\nArguments\n\nŒº::Float64: Rate scaling factor (must be positive)\n\nReturns\n\nModel{ProteinType}: Configured WAG model\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.evolve_sequence-Tuple{Model{DNAType}, BioSequences.LongSequence{BioSequences.DNAAlphabet{4}}, Float64}","page":"Home","title":"EvolutionModels.evolve_sequence","text":"evolve_sequence(model::Model{DNAType}, seq::LongDNA{4}, t::Float64; \n               rng::AbstractRNG=Random.GLOBAL_RNG) -> LongDNA{4}\n\nSimulate DNA sequence evolution under a continuous-time Markov model for time t.\n\nThe function implements the following process:\n\nComputes transition probability matrix P(t) = exp(Qt)\nFor each site, samples new nucleotide from the probability distribution given by the corresponding row of P(t)\nPreserves non-standard nucleotides (gaps, ambiguous bases) unchanged\n\nArguments\n\nmodel::Model{DNAType}: DNA evolution model (JC69, HKY85, or GTR)\nseq::LongDNA{4}: Input DNA sequence\nt::Float64: Evolution time (branch length)\nrng::AbstractRNG=Random.GLOBAL_RNG: Random number generator\n\nReturns\n\nLongDNA{4}: Evolved DNA sequence of the same length as input\n\nExample\n\n# Create model and evolve sequence\nmodel = create_model(JC69Model, 0.1)\nseq = dna\"ATCG\"\nevolved = evolve_sequence(model, seq, 1.0)\n\n# Use specific RNG for reproducibility\nrng = MersenneTwister(42)\nevolved = evolve_sequence(model, seq, 1.0, rng=rng)\n\nNote: For very small t, few changes are expected. As t‚Üí‚àû, nucleotide frequencies approach the model's stationary distribution œÄ.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.evolve_sequence-Tuple{Model{ProteinType}, BioSequences.LongAA, Float64}","page":"Home","title":"EvolutionModels.evolve_sequence","text":"evolve_sequence(model::Model{ProteinType}, seq::LongAA, t::Float64; \n               rng::AbstractRNG=Random.GLOBAL_RNG) -> LongAA\n\nSimulate protein sequence evolution under empirical amino acid substitution models.\n\nThe function implements the following process:\n\nComputes transition probability matrix P(t) = exp(Qt)\nFor each site, samples new amino acid from the probability distribution given by the corresponding row of P(t)\nPreserves non-standard amino acids (gaps, ambiguous residues) unchanged\n\nArguments\n\nmodel::Model{ProteinType}: Protein evolution model (WAG or LG)\nseq::LongAA: Input amino acid sequence\nt::Float64: Evolution time (branch length)\nrng::AbstractRNG=Random.GLOBAL_RNG: Random number generator\n\nReturns\n\nLongAA: Evolved amino acid sequence of the same length as input\n\nExample\n\n# Create model and evolve sequence\nmodel = create_model(WAGModel, 0.1)\nseq = aa\"ARND\"\nevolved = evolve_sequence(model, seq, 1.0)\n\nNote: The empirical models (WAG, LG) use pre-computed rate matrices derived from large protein alignments, representing \"average\" evolutionary patterns.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.is_transition-Tuple{BioSymbols.DNA, BioSymbols.DNA}","page":"Home","title":"EvolutionModels.is_transition","text":"Check if two symbols are transitions (A‚ÜîG or C‚ÜîT)\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.load_empirical_data-Tuple{String}","page":"Home","title":"EvolutionModels.load_empirical_data","text":"load_empirical_data(filepath::String)\n\nLoad empirical substitution matrix and frequencies from a data file. Internal helper function for specific model loaders.\n\nFormat\n\nFile should contain:\n\nLines 1-19: Lower triangular elements of the 20√ó20 substitution rate matrix\nLine 22: Vector of 20 equilibrium frequencies\n\nThe amino acid order follows STANDARD_AA: A R N D C Q E G H I L K M F P S T W Y V\n\nArguments\n\nfilepath::String: Path to the data file\n\nReturns\n\nTuple{Matrix{Float64}, Vector{Float64}}: Rate matrix and frequency vector\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.load_lg_frequencies-Tuple{}","page":"Home","title":"EvolutionModels.load_lg_frequencies","text":"load_lg_frequencies()\n\nLoad LG amino acid frequencies from LG.dat. Returns equilibrium frequencies in STANDARD_AA order.\n\nCitation\n\nLe & Gascuel (2008). DOI: 10.1093/molbev/msn067\n\nReturns\n\nVector{Float64}: Vector of 20 equilibrium frequencies\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.load_lg_rates-Tuple{}","page":"Home","title":"EvolutionModels.load_lg_rates","text":"load_lg_rates()\n\nLoad LG substitution rates matrix from LG.dat. Returns a 20√ó20 symmetric matrix of amino acid substitution rates.\n\nCitation\n\nLe & Gascuel (2008). DOI: 10.1093/molbev/msn067\n\nReturns\n\nMatrix{Float64}: 20√ó20 symmetric rate matrix\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.load_wag_frequencies-Tuple{}","page":"Home","title":"EvolutionModels.load_wag_frequencies","text":"load_wag_frequencies()\n\nLoad WAG amino acid frequencies from WAG.dat. Returns equilibrium frequencies in STANDARD_AA order.\n\nCitation\n\nWhelan & Goldman (2001). DOI: 10.1093/oxfordjournals.molbev.a003851\n\nReturns\n\nVector{Float64}: Vector of 20 equilibrium frequencies\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.load_wag_rates-Tuple{}","page":"Home","title":"EvolutionModels.load_wag_rates","text":"load_wag_rates()\n\nLoad WAG substitution rates matrix from WAG.dat. Returns a 20√ó20 symmetric matrix of amino acid substitution rates.\n\nCitation\n\nWhelan & Goldman (2001). DOI: 10.1093/oxfordjournals.molbev.a003851\n\nReturns\n\nMatrix{Float64}: 20√ó20 symmetric rate matrix\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.rate_matrix-Tuple{Model}","page":"Home","title":"EvolutionModels.rate_matrix","text":"Get the rate matrix R (includes Œº scaling).\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.sequence_likelihood-Tuple{Model, Union{BioSequences.LongAA, BioSequences.LongDNA{4}, BioSequences.LongNuc{4, BioSequences.DNAAlphabet{4}}}, Union{BioSequences.LongAA, BioSequences.LongDNA{4}, BioSequences.LongNuc{4, BioSequences.DNAAlphabet{4}}}, Float64}","page":"Home","title":"EvolutionModels.sequence_likelihood","text":"sequence_likelihood(model::Model, seq1::Union{LongDNA{4},LongAA}, \n                   seq2::Union{LongDNA{4},LongAA}, t::Float64) -> Float64\n\nCompute the log-likelihood of evolving from sequence1 to sequence2 in time t under the given evolutionary model.\n\nThe likelihood is computed as:\n\nL = ·µ¢ P(t)x‚ÇÅ·µ¢ x‚ÇÇ·µ¢\n\nwhere P(t) is the transition probability matrix and x‚ÇÅ·µ¢, x‚ÇÇ·µ¢ are the states at position i in sequences 1 and 2 respectively.\n\nArguments\n\nmodel::Model: Evolution model (DNA or protein)\nseq1::Union{LongDNA{4},LongAA}: First sequence\nseq2::Union{LongDNA{4},LongAA}: Second sequence\nt::Float64: Evolution time between sequences\n\nReturns\n\nFloat64: Log-likelihood of the evolution from seq1 to seq2\n\nExample\n\n# Compare likelihoods for different evolution times\nmodel = create_model(JC69Model, 0.1)\nseq1 = dna\"ATCG\"\nseq2 = dna\"ATTG\"\n\nL1 = sequence_likelihood(model, seq1, seq2, 0.1)  # Short time\nL2 = sequence_likelihood(model, seq1, seq2, 10.0)  # Long time\n\nNote: Only standard nucleotides/amino acids contribute to the likelihood. Non-standard characters (gaps, ambiguous bases) are ignored in the calculation.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.stationary_frequencies-Tuple{Model}","page":"Home","title":"EvolutionModels.stationary_frequencies","text":"Get the stationary distribution œÄ.\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.symbol_index-Tuple{BioSymbols.DNA, DNAType}","page":"Home","title":"EvolutionModels.symbol_index","text":"Get index of a symbol in the canonical ordering\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.transition_probability_matrix-Tuple{Model, Float64}","page":"Home","title":"EvolutionModels.transition_probability_matrix","text":"Compute transition probability matrix P(t) = exp(Qt).\n\n\n\n\n\n","category":"method"},{"location":"#EvolutionModels.validate_frequencies-Union{Tuple{S}, Tuple{Vector{Float64}, S}} where S<:SequenceType","page":"Home","title":"EvolutionModels.validate_frequencies","text":"Validate frequencies vector\n\n\n\n\n\n","category":"method"}]
}
